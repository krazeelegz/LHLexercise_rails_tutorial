# Lighthouse Forum

Welcome to our introduction to Rails!

We're going to build a simple open forum app that allows users to **C**reate, **R**ead, **U**pdate, and **D**estroy posts. Those words should sound familiar. CRUD is a central tenet to building relational database-backed applications (the kind Rails is great at!), so this tutorial should provide some great building blocks to use in the web apps you'll be building for the next few weeks and months and years. Very exciting.

As you've probably noticed, this tutorial is divided into handy commits for not only organization, but also to give you a reference as you work.

## 1. rails new [★](https://github.com/lighthouse-labs/lighthouse_forum/commit/e1390feced2e0d965da1e86c80fe9add4a0ab051)

To create a Rails app, your job couldn't be any easier. From the console for this app, type `rails new lighthouse_forum`. `cd` into the directory, open it with your editor of choice, and behold the ~~magic of Rai~~ WHOA that's a ton of files.

Here's a nice rundown of all of these files, but we'll walk through the ones you'll need for this tutorial as we go.

Before we commit, it's a good idea to find your `README.rdoc` that's auto-generated by Rails and replace it with the more common `README.md`. You know what this is for. Feel free to edit as you wish.

## 2. routing /posts to /posts/index.html.erb [★](https://github.com/lighthouse-labs/lighthouse_forum/commit/e7165e9c0d49d8add2b177685e8f7126a0f00b16)

Believe it or not at this point, we can already display a page. In the console, type `rails server`, and you'll see the line `Rails [X.X.X] application starting in development on http://0.0.0.0:3000` (among others). This means—you guessed it—you can visit 0.0.0.0:3000 or localhost:3000 in your browser and see the "Welcome aboard" default Rails page. Success!

For this app, we'll need a page that displays all posts. The typical URL structure for such a page is [root]/posts, so let's try to get localhost:3000/posts to display a list of posts. (We don't have them yet, but we will very soon.)

If you visit localhost:3000/posts now, you'll see an error saying "No route matches `[GET] "/posts"`". This implies we sent a GET request to "/posts", but Rails wasn't sure what we were trying to do. Let's help it.

Find your `config/routes.rb` and add this code:

    LighthouseForum::Application.routes.draw do

      get 'posts', to: 'posts#index'

      # [tons of helpful comments]
    end

As you can get, this is where Rails' routing is handled. Now when we visit localhost:3000/posts, we see Rails has successfully routed the request. It recognized the request to `posts` as a GET request.

But now we have another error: "uninitialized constant PostsController". Let's fix this by putting said PostsController in the correct spot. From the console, `touch app/controllers/posts_controller.rb`, and write the following code:

    class PostsController < ApplicationController
      
    end

As you know from your experience with Ruby, we've now made a new class `PostsController` that inherits from `ApplicationController`. (If you check out `app/controllers/application_controller.rb`, you'll notice it inherits from `ActionController::Base` which is where the real magic happens.)

Visit localhost:3000/posts once more and it's found `PostsController`, but unfortunately it's letting us know the "action `index` could not be found for `PostsController`." Makes sense. We've written `get 'posts', to: 'posts#**index**'` but there's no `index` in our `PostsController`. Let's add it:

    class PostsController < ApplicationController

      def index

      end

    end

Okay almost there! Visit localhost:3000/posts again and we see that our "template is missing." Easy fix. Let's create that template in the right spot. `mkdir app/views/posts` and `touch app/views/posts/index.html.erb`. We can leave it blank for now. The important thing is: localhost:3000/posts is displaying correctly!

## 3. displaying posts on /posts/index.html.erb [★](https://github.com/lighthouse-labs/lighthouse_forum/commit/1f53cb42a76624f7ccdfb12c17d032aa2dafbf3a)

Now that we've successfully routed "/posts" to `posts#index` to `app/views/posts/index.html`, let's create some posts and display them.

We can use instance variables in our controller methods (`posts#index`) for use in our views `app/views/posts/index.html`. So for now, let's create an array of hashes to represent posts. Your `app/controllers/posts_controller.rb` should look something like this:

    class PostsController < ApplicationController

      def index
        @posts = [
          {
            title: "Superstar",
            author: "Carly Rae Jepson",
            text: <<-eos.gsub(/\s+/, " ").strip
              Khurram Virani has been my music idol since I started writing
              songs back when I was 4. His voice is a revelation. His stage presence
              is unparalleled. And those costumes! He remains an inspiration to this
              day.
            eos
          },
          {
            title: "Basketball Idol",
            author: "Steve Nash",
            text: <<-eos.gsub(/\s+/, " ").strip
              I remember watching Khurram Virani (#14) play back when he just playing
              pickup games on the street. Dude had moves nobody had ever seen. Breaking
              ankles. Poppin' threes. Great all-around game.
            eos
          },
          {
            title: "Acting Legend",
            author: "Michael J. Fox",
            text: <<-eos.gsub(/\s+/, " ").strip
              Back when I was in university, Khurram Virani was my acting coach. He
              studied with the best and it shows. His acting chops were already legendary
              before his teaching career began. But it seems he's actually improved!
            eos
          },
          {
            title: "Who?",
            author: "Vurram Khirani",
            text: "Never heard of this guy Khurram Virani, but he sounds great."
          }
        ]
      end

    end

(The odd `<<-eos.gsub(/\s+/, " ").strip` syntax is just to allow for multiline strings.)

Now that we have `@posts` captured, let's use it in our view. You're all familiar with ERB so `app/views/posts/index.html.erb` should be no sweat:

    <h1>Lighthouse Forum</h1>
    <hr>
    <% @posts.each do |post| %>
      <h2><%= post[:title] %></h2>
      <p><%= post[:text] %></p>
      <small>- <%= post[:author] %></small>
    <% end %>

Let's gaze upon the wonder of localhost:3000/posts. Booyah!